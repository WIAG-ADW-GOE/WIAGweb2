<div class="ps-0">
    <form id ="{{ editFormId }}"
	  name="{{ editFormId }}"
	  action="{{ path('edit_reference_save') }}"
	  method="post"
	  data-controller="submit-form">
	{% set body_id_list = referenceList|map(r => 'body'~attribute(r, "id"))|join(' ') %}
	<div class="row mx-0">
	    <div class="col">
		{# disable submit via enter-key #}
		<button type="submit" disabled style="display: none" aria-hidden="true"></button>
		{# toggle collapse button #}
		<button class="btn btn-sm btn-secondary float-start"
			       type="button"
			       data-bs-toggle="collapse"
			       data-bs-target=".multi-collapse"
			       aria-expanded="false"
			       aria-controls="{{ body_id_list }}"
			       {{ stimulus_controller('toggle-arrow', {
				   state: true,
				   imgOpen: 'down',
				   imgClosed: 'right'
			       }) }}
			       data-action="toggle-arrow#toggle"
			       data-value="down">öffnen/schließen</button>
	    </div>
	    <div class="col">
		<button type="button"
			data-action="submit-form#submit"
			class="btn btn-primary btn-sm float-end">Speichern</button>
	    </div>
	</div>
	<div class="row mx-0">
	    <div class="col-12">
		{% for ref in referenceList %}
		    {{ include('edit_reference/_item.html.twig', {
			index: loop.index0,
			reference: ref,
		    }) }}
		{% endfor %}
	    </div>
	</div>
	{# submit #}
	<div class="row mx-2">
	    <div class="col">
		{% set submit_debug=false %} {# submit directly for debugging#}
		{% if submit_debug %}
		    <button type="submit"
			    formaction="{{ path('edit_reference_save') }}"
			    data-controller="submit-by-key"
			    class="btn btn-primary btn-sm float-end">Speichern</button>
		{% else %} {# submit via Stimulus controller #}
		    <button type="button"
			    data-action="submit-form#submit"
			    data-controller="submit-by-key"
			    class="btn btn-primary btn-sm float-end">Speichern</button>
		{% endif %}
	    </div>
	</div>
    </form>
</div>
